@layer components {
	article {
		counter-reset: section;

		@apply space-y-xl;

		& > section:first-child {
			@apply mt-xl;
		}

		& > section:last-child {
			@apply mb-0;
		}
	}

	section {
		@apply space-y-lg my-[4rem] lg:my-[8rem];
	}

	section > :nth-child(2) {
		margin-top: --theme(--spacing-lg);
	}

	article h2 {
		counter-increment: section;
		counter-reset: subsection figure;
		margin-bottom: 0px;

		position: sticky;
		top: 0;
		background: --theme(--color-article);
		z-index: 10;

		&::before {
			content: counter(section) ". " / "";
		}

		@media (min-width: 768px) {
			position: static;
		}
	}

	article h3 {
		counter-increment: subsection;
		counter-reset: subsubsection figure;
		margin-bottom: 0px;

		&::before {
			content: counter(section) "." counter(subsection) ". " / "";
		}
	}

	article h4 {
		counter-increment: subsubsection;
		counter-reset: figure;
		margin-bottom: 0px;

		&::before {
			content: counter(section) "." counter(subsection) "." counter(subsubsection) ". " / "";
		}
	}

	figure {
		counter-increment: figure;
	}

	article > section > figure > figcaption::before {
		content: attr(data-figcaption) " " counter(section) "-" counter(figure) ": " / "";
	}

	article > section > section > figure > figcaption::before {
		content: attr(data-figcaption) " " counter(section) "." counter(subsection) "-" counter(figure) ": " / "";
	}

	article > section > section > section > figure > figcaption::before {
		content: attr(data-figcaption) " " counter(section) "." counter(subsection) "." counter(subsubsection) "-" counter(figure) ": " / "";
	}

	[data-figure] {
		@apply bg-brand-950 p-lg;
	}

	[data-picture] {
		position: relative;
		isolation: isolate;
		overflow: hidden;
		display: block;
	}

	[data-picture="loading"]::before {
		content: '' / "";
		background: var(--lqip) no-repeat center center / cover;
		transform: scale(1.05);
		filter: blur(16px);
		z-index: -1;
		position: absolute;
		inset: 0;
	}

	[data-image] {
		@apply transition-all duration-2000;
	}

	[data-image="loading"] {
		@apply opacity-0 scale-125;
	}

	[data-figcaption] {
		@apply bg-brand-900 p-md font-atkinson-mono font-medium text-base text-center text-balance;
	}

	[data-link="text"] {
		@apply inline-flex items-center gap-[0.375rem];
		@apply text-brand-500 underline decoration-brand-50/25;
		@apply hover:text-brand-600 hover:decoration-brand-600;
		@apply focus-visible:text-brand-600 focus-visible:decoration-brand-600;

		&:hover [data-link-external-icon], &:focus-visible [data-link-external-icon] {
			& > img {
				@apply opacity-0;
			}

			& > svg {
				@apply opacity-100;
			}
		}
	}

	[data-link-external-icon] {
		@apply relative;

		& > img {
			@apply absolute inset-0 size-text rounded-sm transition-opacity;
		}

		& > svg {
			@apply size-text stroke-2 opacity-0 transition-opacity;
		}
	}
}
