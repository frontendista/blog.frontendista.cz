---
import Layout from "@/components/layout.astro";
import { Seo as SEO } from "astro-seo-meta";
import { getEntry, render } from "astro:content";
import consola from "consola";
import Heading from "./components/heading.astro";
import Section from "./components/section.astro";

export interface Props {
	slug: string;
}

const article = await getEntry("articles", Astro.props.slug);

if (!article) {
	throw new Error("Article not found");
}

if (article.data.cover_photo.image.width / article.data.cover_photo.image.height !== 16 / 9) {
	consola.warn(`Article ${article.id} has a cover photo with an aspect ratio of ${article.data.cover_photo.image.width / article.data.cover_photo.image.height}. It should be 16:9.`);
}

const { Content } = await render(article);

const {
	// cover_photo,
	title,
	description
	// authors,
	// published_at,
	// language
} = article.data;
---

<Layout lang={article.data.language}>
	<SEO {title} {description} slot="head" />
	<main class="lg:ml-[38.2%] max-w-[67.5rem] lg:-translate-x-[38.2%]">
		<article class="space-y-2xl">
			<Content
				components={{
					section: Section,
					h1: Heading,
					h2: Heading,
					h3: Heading,
					h4: Heading,
					h5: Heading,
					h6: Heading
				}}
			/>
		</article>
	</main>
</Layout>
